{% comment %}
  Homepage Template
  Displays the main landing page with hero, benefits, lead form, and testimonials sections
  Requirements: 1.1, 1.5, 2.1, 7.1
{% endcomment %}

{% comment %} SEO Meta Tags for Homepage {% endcomment %}
{% liquid
  assign page_title = settings.homepage_title | default: 'Encuentra la casa de tus sueños'
  assign page_description = settings.homepage_description | default: 'Encuentra la propiedad perfecta con nosotros. Casas, departamentos y terrenos en las mejores ubicaciones. Asesoría personalizada y procesos transparentes.'
  
  if shop.name != blank
    assign page_description = page_description | replace: 'nosotros', shop.name
  endif
%}

{% comment %} Structured Data for Homepage {% endcomment %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "RealEstateAgent",
  "name": "{{ shop.name }}",
  "url": "{{ shop.url }}",
  "description": "{{ page_description | escape }}",
  "address": {
    "@type": "PostalAddress",
    "addressCountry": "MX"
  },
  "contactPoint": {
    "@type": "ContactPoint",
    "telephone": "{{ settings.phone_number }}",
    "contactType": "customer service"
  }
}
</script>

{% comment %} Main Content Area {% endcomment %}
<main id="MainContent" class="content-for-layout focus-none" role="main" tabindex="-1">
  
  {% comment %} Hero Section - Requirement 1.1, 1.2, 1.3, 1.4 {% endcomment %}
  <section class="homepage-section homepage-section--hero">
    {% section 'hero' %}
  </section>
  
  {% comment %} Benefits Section - Requirement 1.5 {% endcomment %}
  <section class="homepage-section homepage-section--benefits">
    {% section 'benefits' %}
  </section>
  
  {% comment %} Lead Capture Form - Requirement 2.1 {% endcomment %}
  <section class="homepage-section homepage-section--lead-form">
    {% section 'lead-form' %}
  </section>
  
  {% comment %} Testimonials Section - Requirement 7.1 {% endcomment %}
  <section class="homepage-section homepage-section--testimonials">
    {% section 'testimonials' %}
  </section>
  
  {% comment %} Additional Sections from Theme Customizer {% endcomment %}
  {% for section in section.blocks %}
    <section class="homepage-section homepage-section--custom">
      {% render section %}
    </section>
  {% endfor %}
  
</main>

{% comment %} Homepage-specific JavaScript {% endcomment %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Smooth scrolling for anchor links
    const anchorLinks = document.querySelectorAll('a[href^="#"]');
    anchorLinks.forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });
    
    // Initialize form validation if lead form exists
    const leadForm = document.getElementById('lead-capture-form');
    if (leadForm && typeof window.initFormValidation === 'function') {
      window.initFormValidation();
    }
    
    // Add intersection observer for section animations
    if ('IntersectionObserver' in window) {
      const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      };
      
      const observer = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('animate-in');
          }
        });
      }, observerOptions);
      
      // Observe all main sections
      const sections = document.querySelectorAll('.hero, .benefits, .lead-form, .testimonials');
      sections.forEach(section => {
        observer.observe(section);
      });
    }
  });
</script>

{% schema %}
{
  "name": "Homepage",
  "settings": [
    {
      "type": "header",
      "content": "SEO Settings"
    },
    {
      "type": "text",
      "id": "homepage_title",
      "label": "Homepage Title",
      "default": "Encuentra la casa de tus sueños",
      "info": "This will be used in the page title and meta tags"
    },
    {
      "type": "textarea",
      "id": "homepage_description",
      "label": "Homepage Description",
      "default": "Encuentra la propiedad perfecta con nosotros. Casas, departamentos y terrenos en las mejores ubicaciones. Asesoría personalizada y procesos transparentes.",
      "info": "This will be used in meta description for SEO (max 160 characters recommended)"
    },
    {
      "type": "header",
      "content": "Section Order"
    },
    {
      "type": "paragraph",
      "content": "The homepage displays sections in this order: Hero → Benefits → Lead Form → Testimonials. Additional sections can be added through the theme customizer."
    }
  ],
  "blocks": [
    {
      "type": "@app"
    },
    {
      "type": "hero",
      "name": "Hero Section",
      "limit": 1
    },
    {
      "type": "benefits",
      "name": "Benefits Section",
      "limit": 1
    },
    {
      "type": "lead-form",
      "name": "Lead Form Section",
      "limit": 1
    },
    {
      "type": "testimonials",
      "name": "Testimonials Section",
      "limit": 1
    }
  ],
  "presets": [
    {
      "name": "Homepage",
      "blocks": [
        {
          "type": "hero"
        },
        {
          "type": "benefits"
        },
        {
          "type": "lead-form"
        },
        {
          "type": "testimonials"
        }
      ]
    }
  ]
}
{% endschema %}